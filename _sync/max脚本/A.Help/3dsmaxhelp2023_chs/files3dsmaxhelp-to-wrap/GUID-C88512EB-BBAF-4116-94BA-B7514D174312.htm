<!DOCTYPE html><html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <meta name="product" content="3DSMAX">
      <meta name="release" content="2023">
      <meta name="book" content="GeneralUser">
      <meta name="created" content="2022-03-27">
      <meta name="topicid" content="GUID-C88512EB-BBAF-4116-94BA-B7514D174312">
      <meta name="description" content="脚本控制器与表达式控制器运行方式类似。这些版本提供了一个可在其中为计算控制器值输入脚本的“脚本控制器”对话框。">
      <meta name="indexterm" content="控制器: 脚本">
      <meta name="indexterm" content="控制器: 浮点脚本">
      <meta name="indexterm" content="控制器: 位置脚本">
      <meta name="indexterm" content="控制器: Point3 脚本">
      <meta name="indexterm" content="控制器: 旋转脚本">
      <meta name="indexterm" content="控制器: 缩放脚本">
      <meta name="indexterm" content="控制器: 变换脚本">
      <meta name="indexterm" content="脚本: 脚本控制器">
      <meta name="indexterm" content="浮点脚本控制器">
      <meta name="indexterm" content="位置脚本控制器">
      <meta name="indexterm" content="Point3 脚本控制器">
      <meta name="indexterm" content="旋转脚本控制器">
      <meta name="indexterm" content="缩放脚本控制器">
      <meta name="indexterm" content="变换脚本控制器">
      <meta name="topic-type" content="concept">
      <title>脚本控制器</title><script language="javascript">var index = 'index3dsmaxhelp.html';</script></head>
   <body height="100%">
      <div class="body_content" id="body-content" dir="ltr"><a name="GUID-C88512EB-BBAF-4116-94BA-B7514D174312"></a><div class="head">
            <h1>脚本控制器</h1>
         </div>
         <p class="blurb">脚本控制器与<span class="char_link"><a href="GUID-65186F02-824B-4BBE-8559-69275E036E6C.htm">表达式控制器</a></span>运行方式类似。这些版本提供了一个可在其中为计算控制器值输入脚本的“脚本控制器”对话框。 
         </p><a name="UL_65A425D01AAE4E389EA7CA2CE3F59E7B"></a><ul>
            <li> <span class="MenuCascade" id="GUID-79C175E3-7B06-4821-AEBE-2B25DBD679D7">指定控制器  <img src="../images/ac.menuaro.gif">  ...脚本</span> 
            </li>
         </ul>
         <p><a name="WS1A9193826455F5FF103859C11318F51BDD-4175"></a>可以在 <span class="charspan-msgph">3ds Max</span> 中使用以下“脚本”控制器： 
         </p><a name="WS1A9193826455F5FFBA679E112A6A190044B5F"></a><ul>
            <li>浮点脚本：浮点控制器 </li>
            <li>Point3 脚本：Point3 控制器 </li>
            <li> <span class="char_link"><a href="GUID-C88512EB-BBAF-4116-94BA-B7514D174312.htm#WS1A9193826455F5FF4E421D7D11BF108001D-4C34">变换脚本</a></span>：matrix3 PRS 控制器 
            </li>
            <li>位置脚本：位置 Point3 控制器 </li>
            <li>旋转脚本：旋转“四元数”控制器 </li>
            <li>缩放脚本：缩放 Point3 控制器 </li>
         </ul>
         <p><a name="WS73099CC142F48755-4CE33D2411F6744DABF-7070"></a>不同类型的“脚本”控制器之间的区别主要在于您可以将其指定到的动画轨迹的类型不同。例如，将“变换脚本”控制器指定给“变换轨迹”；将“位置脚本”控制器指定给“位置”轨迹；如果“位置”控制器为“位置 XYZ”，则还可以将“浮点脚本”控制器指定给所有单独的“位置”轨迹（位置
            X/Y/Z）。 
         </p><a name="WS1A9193826455F5FFBA679E112A6A190044B5C"></a><div class="figure-anchor"><img src="../images/GUID-2B15994E-78F6-450D-A79A-7AE3D84D520F-low.png"></div>
         <p><a name="WS1A9193826455F5FF103859C11318F51BDD-4174"></a>脚本控制器的主要优点是： 
         </p><a name="WS1A9193826455F5FFBA679E112A6A190044B60"></a><ul>
            <li>它们能够使用 <span class="char_link"><a href="GUID-FE40F021-5444-4709-BF08-DF1F1F0960C3.htm">MAXScript</a></span> 语言的所有功能，包括循环、脚本功能和路径名。 
            </li>
            <li>几乎可以使用场景中对象的任一属性来辅助计算控制器的值，包括网格顶点，任意帧时间属性值以及其他在表达式控制器中不可访问的非动画属性。 </li>
            <li>可以使用 MAXScript 全局变量，与 <span class="charspan-msgph">3ds Max</span> 中其他控制器和脚本进行沟通和协调。 
            </li>
         </ul>
         <p><a name="WS1A9193826455F5FF103859C11318F51BDD-4173"></a>有关该脚本语言的完整说明，请参考“MAXScript 帮助”。 
         </p>
         <div class="section"><a name="WS1A9193826455F5FF4E421D7D11BF108001D-4C34"></a> 
            <h2><a name="GUID-2F8005B9-CE54-4B95-B04F-6A02CF2DC5AE"></a>变换脚本控制器
            </h2> 
            <p><a name="WS1A9193826455F5FF4E421D7D11BF108001D-4C33"></a>“变换脚本”控制器在一个脚本化矩阵值中包含<span class="char_link"><a href="GUID-15DC3D4F-D69D-42B8-8441-41AAD883D0A5.htm">位置/旋转/缩放 (PRS) 控制器</a></span>含有的所有信息。可以从一个脚本控制器对话框中同时访问全部三个值，而不是为位置、旋转和缩放控制器分配三个单独轨迹。因为脚本定义了变换值，因此更易于设置动画。 
            </p> 
            <p><a name="WS1A9193826455F5FF4E421D7D11BF108001D-4C32"></a>控制器脚本的值必须是 matrix3 值。matrix3 值是 4x3 3D 变换距阵。有关详细信息，请参见 MAXScript 帮助中的“Matrix3 值”主题。 
            </p> 
         </div>
         <div class="section"><a name="WS1A9193826455F5FFBA679E112A6A190044B61"></a> 
            <h2><a name="GUID-D91B60A1-87BB-4D00-A8CD-8AC366F66809"></a>编写控制器脚本
            </h2> 
            <p><a name="WS1A9193826455F5FF103859C11318F51BDD-4172"></a> <span class="charspan-msgph">3ds Max</span> 将输入到“脚本”文本框中的文本解释为 MAXScript 块表达式的主体。您可以按照所需的行数键入很多表达式，并依次进行计算。最后一个表达式的值将作为控制器的值。该值会针对不同的控制器生成相应的类型：即为浮点控制器生成 float，为位置控制器生成
               point3，为旋转控制器生成 quat，为变换控制器生成 matrix3 等。 
            </p> 
            <p><a name="WS1A9193826455F5FF103859C11318F51BDD-4171"></a>由于文本在块表达式中，所以可以声明只在脚本中可见的并临时在评估中的局部变量。还可以声明或访问与 MAXScript 中的其他所有脚本共享的全局变量，并保留从一个计算到下一个计算的值。 
            </p> 
            <p><a name="WS1A9193826455F5FF103859C11318F51BDD-4170"></a>控制器始终由 <span class="charspan-msgph">3ds Max</span> 根据特定的动画时间来计算。如果正在播放动画或正在进行渲染，则这可能是当前时间滑块或增量帧时间。在脚本控制器中，所计算的时间用于围绕控制器脚本建立自动“时间”上下文，因此访问的任何属性（其他显式“时间”表达式除外）将为当前控制器计算时间生成正确的值。这意味着不必在脚本中进行任何特殊操作即可在正确的时间工作。可以用标准
               MAXScript 变量 currentTime 访问计算时间。还可以通过在脚本中使用“时间”表达式（与在正则 MAXScript 编程中一样）引用其他时间的场景属性值。 
            </p> 
         </div>
         <div class="section"><a name="WS1A9193826455F5FFBA679E112A6A190044B62"></a> 
            <h2><a name="GUID-8E9F1747-5980-4A87-88D3-4BD7D9085609"></a>给变量指定节点和轨迹
            </h2> 
            <p><a name="WS1A9193826455F5FF103859C11318F51BDD-416F"></a>当需要参考场景中的节点或动画轨迹时，建议您使用“脚本”控制器变量工具组创建变量，来指定给任何特定的节点或控制器轨迹。这样，如果您决定以后重命名场景对象，就保留了使用这些对象的脚本控制器，因为变量保持了到节点的链接。 
            </p> 
            <p><a name="WS1A9193826455F5FF103859C11318F51BDD-416E"></a>否则，例如，您在对话框的“表达式”窗口中手动将节点指定给变量，则只要您重命名该特定节点，该链接就会断开。 
            </p> 
            <div><a name="WS1A9193826455F5FFBA22E1113C6C30C0E528"></a><div class="note-note"><span class="label label-target-language">注意:</span>在使用外部参照场景和对象时，用相应的按钮将节点和轨迹指定给变量尤其重要。 
               </div>
            </div> 
         </div>
         <div class="section"><a name="WS1A9193826455F5FF103859C11318F51BDD-416D"></a> 
            <h2><a name="GUID-9F559B5E-D4B6-4AE9-86FC-6C42C0AE8476"></a>过程
            </h2> <a name="WS1A9193826455F5FFBA679E112A6A190044B63"></a><p class="list-intro"><a name="WS1A9193826455F5FFBA679E112A6A190044B64"></a>示例：要在动画期间，保持对象相对于场景中的其他对象居中，请执行以下操作：
            </p>
            <ol type="1" start="1">
               <li>为应该保持居中的对象命名 <em class="strong">foo</em> 并为“位置”轨迹指定“脚本”控制器。 
               </li>
               <li>在“名称”字段输入 <em class="mild">foo</em>，然后单击“创建”。 
                  <p><a name="WS1A9193826455F5FF103859C11318F51BDD-416C"></a>新变量自动添加到“变量”列表。 
                  </p> 
               </li>
               <li>高亮显示变量，然后单击“指定节点”。 
                  <p><a name="WS1A9193826455F5FF103859C11318F51BDD-416B"></a>将打开“轨迹视图拾取”对话框，其中列出了场景的内容。 
                  </p> 
               </li>
               <li>展开“对象”层次，直到您找到 foo。将其高亮显示，然后单击“确定”。 
                  <p><a name="WS1A9193826455F5FF103859C11318F51BDD-416A"></a>foo 节点便指定给您的变量。 
                  </p> 
               </li>
               <li>在“脚本控制器”对话框的“表达式”窗口中输入以下脚本： 
                  <p><a name="WS1A9193826455F5FF103859C11318F51BDD-4169"></a> <em class="strong">local pos=[0,0,0]</em> 
                  </p> 
                  <p><a name="WS1A9193826455F5FF103859C11318F51BDD-4168"></a> <em class="strong">for o in objects where o != foo do</em> 
                  </p> 
                  <p><a name="WS1A9193826455F5FF103859C11318F51BDD-4167"></a> <em class="strong">pos += o.pos</em> 
                  </p> 
                  <p><a name="WS1A9193826455F5FF103859C11318F51BDD-4166"></a> <em class="strong">pos / (objects.count - 1)</em> 
                  </p> 
                  <p><a name="WS1A9193826455F5FF103859C11318F51BDD-4165"></a>这个脚本可以通过以下方式计算除当前对象（在此写为 foo）之外所有对象的平均位置：对局部进行设置，对除了 foo 之外的所有对象反复演算，对总位置向量进行积累，对最后一行的平均值进行计算，这是该脚本的最后结果。 
                  </p> 
               </li>
            </ol> <a name="WS1A9193826455F5FFBA679E112A6A190044B8C"></a><p class="list-intro"><a name="WS1A9193826455F5FFBA679E112A6A190044B8D"></a>要使用变换脚本控制器，请执行以下操作：
            </p>
            <ol type="1" start="1">
               <li> <img src="../images/GUID-AEA0DCE7-AEB5-4739-B941-449CC7232C3F-low.png"> 选择对象。 
               </li>
               <li>右键单击以打开四元菜单。 </li>
               <li>在“变换”区域中，单击“曲线编辑器”。 </li>
               <li>在“轨迹视图”中选择选定对象的变换轨迹。 </li>
               <li>从“指定变换控制器”对话框选择“变换脚本”，然后单击“确定”。 
                  <p><a name="WS1A9193826455F5FF103859C11318F51BDD-40E9"></a>“脚本控制器”对话框将打开。 
                  </p> 
               </li>
               <li>在“脚本控制器”对话框中编辑 matrix3 值，完成后单击“计算”。 </li>
            </ol> 
         </div>
         <div class="section"><a name="WS1A9193826455F5FF103859C11318F51BDD-4164"></a> 
            <h2><a name="GUID-3A36D79C-7356-49F9-8C60-F0659CFA44E4"></a>界面
            </h2> <a name="WS1A9193826455F5FFBA679E112A6A190044B65"></a><div class="figure-anchor"><img src="../images/GUID-8124595A-658E-4C4C-9498-5C8916FD8463-low.png"></div>  
            <p><a name="WS1A9193826455F5FF103859C11318F51BDD-4163"></a>自动指定“脚本”控制器能够打开可以输入脚本的“脚本控制器”对话框。要打开随后的对话框，可以右键单击“运动”面板上或者“轨迹视图”层次中的轨迹，选择“属性”，或者单击“轨迹视图”工具栏上的“属性”按钮。 
            </p> 
            <div><a name="WS1A9193826455F5FFBA22E1113C6C30C0E529"></a><div class="note-tip"><span class="label label-target-language">提示</span>通过拖动边或角可调整对话框。 
               </div>
            </div> <a name="GUID-19359811-3B30-44E7-9688-4663834E98AC"></a><div class="dl_section"><a name="GUID-B5D43A2C-0D1E-4ABE-ABF0-2D7AB99E4256"></a><p class="title"><a name="GUID-34514650-0E94-4E42-8D55-6A1FB651FC96"></a>“创建变量”组
               </p>
               <dl>
                  <dt><a name="WS1A9193826455F5FF-4F542F6211C68D07B4A-7815"></a><span class="term"><a name="WS1A9193826455F5FF103859C11318F51BDD-4162"></a>名称</span></dt>
                  <dd>
                     <div class="definition"><a name="WS1A9193826455F5FF-4855151011E22F62443-59FB"></a> 让您输入并编辑用户变量的名称。 
                     </div>
                  </dd>
                  <dt><a name="WS1A9193826455F5FF-4F542F6211C68D07B4A-7814"></a><span class="term"><a name="WS1A9193826455F5FF103859C11318F51BDD-4161"></a>创建</span></dt>
                  <dd>
                     <div class="definition"><a name="WS1A9193826455F5FF-4855151011E22F62443-59FA"></a> 创建一个变量并将其添加到变量列表中。 
                     </div>
                  </dd>
                  <dt><a name="WS1A9193826455F5FF-4F542F6211C68D07B4A-7813"></a><span class="term"><a name="WS1A9193826455F5FF103859C11318F51BDD-4160"></a>删除</span></dt>
                  <dd>
                     <div class="definition"><a name="WS1A9193826455F5FF-4855151011E22F62443-59F9"></a> 从“变量”列表中移除高亮显示的变量。也可以将其名称键入“名称”字段再单击“删除”来删除变量。 
                     </div>
                  </dd>
                  <dt><a name="WS1A9193826455F5FF-4F542F6211C68D07B4A-7812"></a><span class="term"><a name="WS1A9193826455F5FF103859C11318F51BDD-415F"></a>重命名</span></dt>
                  <dd>
                     <div class="definition"><a name="WS1A9193826455F5FF-4855151011E22F62443-59F8"></a> 用于重命名高亮显示的组。 
                     </div>
                  </dd>
               </dl>
            </div>
            <div class="dl_section"><a name="GUID-E82FD478-B381-421D-A189-C9839BE4BCB1"></a><p class="title"><a name="GUID-84D8C369-66A1-456D-A664-F0CBD38917F9"></a>“变量参数”组
               </p>
               <dl>
                  <dt><a name="WS1A9193826455F5FF-4F542F6211C68D07B4A-7811"></a><span class="term"><a name="WS1A9193826455F5FF103859C11318F51BDD-415E"></a>tick 偏移</span></dt>
                  <dd>
                     <div class="definition"><a name="WS1A9193826455F5FF-4855151011E22F62443-59F7"></a> 以刻度为单位指定当前变量的时间偏移。计算脚本时，从当前时间和“tick 偏移”值设置该变量的值。 
                        <div><a name="WS1A9193826455F5FFBA22E1113C6C30C0E52A"></a><div class="note-note"><span class="label label-target-language">注意:</span>“时间偏移”对指定为常量的变量不起作用。 
                           </div>
                        </div> 
                     </div>
                  </dd>
               </dl>
            </div>
            <dl>
               <dt><a name="GUID-E73FB4AE-D429-4A55-833F-3B91508F425F"></a><span class="term"><a name="GUID-3C84A73A-A19D-482B-972E-2FDB3C404246"></a>变量列表</span></dt>
               <dd>
                  <div class="definition"><a name="GUID-6D64858A-3A69-4885-9569-D202F707E31E"></a> 
                     <p><a name="WS1A9193826455F5FF1DBC298511635BEA87527AA"></a>列出控制器中的所有可用变量。在每个脚本控制器中都可以使用以下预定义的常量变量，但是不能将其删除或重命名。 
                     </p> <a name="WS1A9193826455F5FFBA679E112A6A190044B68"></a><ul>
                        <li> <em class="strong">F</em>以帧为单位的当前时间 
                        </li>
                        <li> <em class="strong">NT</em>标准化的时间 
                        </li>
                        <li> <em class="strong">S</em>以秒为单位的当前时间 
                        </li>
                        <li> <em class="strong">T</em>以刻度为单位的当前时间 
                        </li>
                     </ul> 
                  </div>
               </dd>
               <dt><a name="WS1A9193826455F5FF-4F542F6211C68D07B4A-7810"></a><span class="term"><a name="WS1A9193826455F5FF103859C11318F51BDD-415C"></a>指定常量</span></dt>
               <dd>
                  <div class="definition"><a name="WS1A9193826455F5FF-4855151011E22F62443-59F6"></a> 打开一个对话框，可从中将常量指定给高亮显示的变量。 <a name="WS1A9193826455F5FFBA679E112A6A190044B69"></a><div class="figure-anchor"><img src="../images/GUID-88175A76-0251-4D31-9799-E49B0C4032E7-low.png"></div>  <a name="WS1A9193826455F5FF4E421D7D11BF108001D-4C2F"></a><ul>
                        <li> <em class="strong">值表达式</em> 输入任意 MAXScript 值或表达式（如整数、浮点、数组等）。 
                        </li>
                        <li> <em class="strong">值表达式结果</em>显示以上表达式的结果。 
                        </li>
                        <li> <em class="strong">计算</em> 在当前时间分析表达式。 
                        </li>
                        <li> <em class="strong">确定</em>将值表达式的结果指定给当前变量。 
                        </li>
                        <li> <em class="strong">取消</em>忽略当前值表达式结果并关闭对话框。 
                        </li>
                     </ul> 
                  </div>
               </dd>
               <dt><a name="WS1A9193826455F5FF-4F542F6211C68D07B4A-780F"></a><span class="term"><a name="WS1A9193826455F5FF103859C11318F51BDD-4155"></a>指定轨迹</span></dt>
               <dd>
                  <div class="definition"><a name="WS1A9193826455F5FF-4855151011E22F62443-59F5"></a> 允许将轨迹指定给高亮显示的变量。 
                  </div>
               </dd>
               <dt><a name="WS1A9193826455F5FF-4F542F6211C68D07B4A-780E"></a><span class="term"><a name="WS1A9193826455F5FF103859C11318F51BDD-4154"></a>指定控制器</span></dt>
               <dd>
                  <div class="definition"><a name="WS1A9193826455F5FF-4855151011E22F62443-59F4"></a> 允许您将控制器指定给高亮显示的变量。在当前时间和变量的“Tick 偏移”上获得控制器的值。 
                  </div>
               </dd>
               <dt><a name="WS1A9193826455F5FF-4F542F6211C68D07B4A-780D"></a><span class="term"><a name="WS1A9193826455F5FF103859C11318F51BDD-4153"></a>指定节点</span></dt>
               <dd>
                  <div class="definition"><a name="WS1A9193826455F5FF-4855151011E22F62443-59F3"></a> 允许将节点指定给高亮显示的变量。 
                  </div>
               </dd>
               <dt><a name="GUID-2BF81F17-B084-4CBD-8EA5-303B4713FABF"></a><span class="term"><a name="GUID-CA303AC4-AD4F-4FB4-9D63-E456DEDF0E14"></a>“表达式”窗口</span></dt>
               <dd>
                  <div class="definition"><a name="GUID-FC4B3408-5BB3-4E1F-BA48-BAFE796D597E"></a>显示要计算的表达式。可以在此窗口中编辑文本。
                  </div>
               </dd>
               <dt><a name="GUID-9D2374EE-C2CE-484D-8DA5-581FEA8BB812"></a><span class="term"><a name="GUID-71E85E58-6499-4BAB-A346-7D07CAA459DC"></a>“描述”窗口</span></dt>
               <dd>
                  <div class="definition"><a name="GUID-7D6403DA-67BA-4845-AFCC-4B1D985EF42B"></a>在此文本窗口中，可以输入与控制器工作原理、使用方式等有关的注释。
                  </div>
               </dd>
               <dt><a name="WS1A9193826455F5FF-4F542F6211C68D07B4A-780C"></a><span class="term"><a name="WS1A9193826455F5FF4E421D7D11BF108001D-4C26"></a>保存</span></dt>
               <dd>
                  <div class="definition"><a name="WS1A9193826455F5FF-4855151011E22F62443-59F2"></a> 单击以将脚本保存至 MAXScript (<em class="mild">.ms)</em> 文本文件。 
                  </div>
               </dd>
               <dt><a name="WS1A9193826455F5FF-4F542F6211C68D07B4A-780B"></a><span class="term"><a name="WS1A9193826455F5FF4E421D7D11BF108001D-4C24"></a>加载</span></dt>
               <dd>
                  <div class="definition"><a name="WS1A9193826455F5FF-4855151011E22F62443-59F1"></a> 单击以从 MAXScript (<em class="mild">.ms)</em> 文本文件中加载脚本。 
                  </div>
               </dd>
               <dt><a name="WS1A9193826455F5FF-4F542F6211C68D07B4A-780A"></a><span class="term"><a name="WS1A9193826455F5FF103859C11318F51BDD-414F"></a>调试</span></dt>
               <dd>
                  <div class="definition"><a name="WS1A9193826455F5FF-4855151011E22F62443-59F0"></a> 打开“脚本控制器调试窗口”，它将显示在脚本中使用的所有变量值。 
                  </div>
               </dd>
               <dt><a name="WS1A9193826455F5FF-4F542F6211C68D07B4A-7809"></a><span class="term"><a name="WS1A9193826455F5FF103859C11318F51BDD-4159"></a>计算</span></dt>
               <dd>
                  <div class="definition"><a name="WS1A9193826455F5FF-4855151011E22F62443-59EF"></a> 计算脚本表达式。将计算时间滑块当前位置的值。 
                  </div>
               </dd>
               <dt><a name="WS1A9193826455F5FF-4F542F6211C68D07B4A-7808"></a><span class="term"><a name="WS1A9193826455F5FF103859C11318F51BDD-414D"></a>关闭</span></dt>
               <dd>
                  <div class="definition"><a name="WS1A9193826455F5FF-4855151011E22F62443-59EE"></a> 编译并检查控制器脚本以发现错误。如果没有发现错误，则关闭该对话框。出现任何问题都会显示询问框，询问您是否将表达式还原为当前轨迹的原始值并关闭对话框（确定），或返回编辑表达式（取消）。 
                  </div>
               </dd>
            </dl> 
         </div>
         <div class="footer-block"><a href=".." class="comments-anchor" target="_blank"><span class="comments-link">请将您关于此页内容的评论发送给我们</span></a></div><br><p class="footer-license-block"><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank"><img alt="Creative Commons License" style="border-width: 0;" src="../images/ccLink.png"></a>&nbsp;<em>除非另有说明，否则此作品受到 <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank"> Creative Commons 署名-非商业性使用-相同方式共享 3.0 未本地化版本许可证</a>的制约。请参见 <a href="http://autodesk.com/creativecommons" target="_blank">Autodesk Creative Commons 常见问题</a>(英文)以获取更多信息。</em></p><br></div>
   </body>
</html>