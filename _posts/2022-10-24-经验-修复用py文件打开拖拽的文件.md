---
layout: post
title: 修复用py文件打开拖拽的文件
date: 2022-10-24 16:20:24.00 +08:00
categories: 经验
tags: 经验 python
comments: false
typora-root-url: ..
---

修复文件拖拽到.py文件运行.
![image-20221024162122665](./assets-images/2022-10-24-经验-修复用py文件打开拖拽的文件-imgs/image-20221024162122665-1666599960910-2.png)

出现这个问题,是因为python文件的拖放注册表出了问题

1. py文件拖放未正确设置(一般不会出现)
2. py文件未映射为Python.File(大概率)

python文件拖拽注册表
`计算机\HKEY_CLASSES_ROOT\Python.File\shellex\DropHandler` --py文件
`计算机\HKEY_CLASSES_ROOT\Python.CompiledFile\shellex\DropHandler` --pyc
`计算机\HKEY_CLASSES_ROOT\Python.NoConFile\shellex\DropHandler` --pyw
`计算机\HKEY_CLASSES_ROOT\Python.NoConArchiveFile\shellex\DropHandler` --??

将上面的默认值设置为正确的值(这个值不同版本可能都不一样,不建议抄网上的值`{86C86720-42A0-1069-A2E8-08002B30309D}`)
一般从其他部分抄一下就行,比如py不能拖拽运行,就抄一下pyc的默认值
如果所有的值都有问题,实在抄不了,就请重新安装python.(虽然为了这个问题我已经重安了好几次python)

然后重启explorer进程(不重新启动是不能立刻生效的哦)
![Pasted image 20221024161348](./assets-images/2022-10-24-经验-修复用py文件打开拖拽的文件-imgs/Pasted image 20221024161348.png)

如果还是不行
`HKEY_CLASSES_ROOT\.py`-> 将默认值设置为`Python.File` (我这里被改成了py_auto_file)
![image-20221024163620028](./assets-images/2022-10-24-经验-修复用py文件打开拖拽的文件-imgs/image-20221024163620028.png)

然后双击py会选择打开方式,选择带火箭的白色python(Python Launcher 而不是 Python,这个只有在py映射为Python.File时才可选)
![Pasted image 20221024161241](./assets-images/2022-10-24-经验-修复用py文件打开拖拽的文件-imgs/Pasted image 20221024161241-1666600502740-6.png)

然后再重启explorer进程