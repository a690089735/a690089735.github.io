---
layout: post
title: Zelda攻击动画复刻
date: 2020-09-17 19:05:33.00 +08:00
categories: 学习
tags: 练习
comments: false
---

_动画这东西,厉害的人用垃圾也能做的很精彩,愚笨如我,用再精致的东西起底,也还是会搞得一塌糊涂._

作为最近学习和研究的总结,打算做一个新的小作品,顺便也丰富一下自己的作品库.

这次的作品打算稍微全面一点,就做一个一直想做而没做过的双人对打小动画吧.顺便记录一下制作历程,充实一下我年轻的博客.

虽然还是想自己做个原创模型作为作品中的模型来用,但是花了几天收集素材和学习之后,终究因为水品跟不上想法,放弃了这个念头.



![zld-pre]({{site.img}}zld-pre.png)

之前收集模型的时候,还是发现过一个不错的模型.原模型的大佬在gumroad上的免费绑定模型(因为是粉丝艺术--同人).

这个模型只有maya的绑定,maya版本的绑定香甜诱人,面面俱到,包括控制器隐藏切换,肢体隐藏切换,材质变化,各种道具武器的隐藏切换,以及一些细节绑定.fbx导入进max只能凑合用,无奈我的maya水平毕竟不如max熟练,只能是想想办法在max里复刻一份差不多的绑定.

[动图,maya绑定的截图]

我平常用max的CS系统比较多(biped),以前偶尔会用一下CAT系统.但是对比这样的绑定,他们二者都略显弱势.

CS系统很难做拉伸IK,次级臂弯,胯部带动什么的,只有默认的四元数比较顺滑,切换成欧拉就会出现各种小BUG.

CAT系统很难做次级臂弯,胯部带动是用一种曲线救国的方式实现的,其他方面都很好,基本满足我的需求,但是IKFK切换的时候脚趾会发生偏移,虽然可以有办法绕过,但是会导致损失一些效果.除此之外CAT系统竟然还和很多MAX自身的系统不能兼容.

这些问题都是数版迭代之后,到了2021还仍未解决的.(两个令人遗憾的经典系统)

[CS和CAT的截图]

之前其实也思考过解决方案,有个做了一半的绑定工具.要不就正好借这次机会给完善完善,做一套自由度更高的绑定系统.考察研究了不少的Bone绑定教程和几款现成的不够完善的绑定工具,确定了模块化自定义的设计,经历了长达半月的多次设计,修复,和重做,解决了肢体绑定的核心功能之后,发现其他部件的绑定方案和用户交互(包括多重生成和容错机制和兼容性测试)还得花上我更长的时间,最近又杂事扰心.遂先将这个半成品放置到一边.毕竟这波练习的目标还是以作品为主,以出效果为先.

[动图:半成品MyRigTool效果]

几经周折,对绑定工具的选择,确定采用几年前流出过学习版的InstantRig,这个工具除了一些原作者自己都没想到的隐藏的坑以外,各个方面完成度都很高.在汉化并修复了其中一些特别影响我的问题之后,IRig很快就投入了使用.最终除了软IK有些问题外,其他的部分基本满足我的需求.(当然还有性能问题,视口帧率下降的厉害,不过IRig的绑定逻辑和max自身限制决定了这些问题无法绕过,最后使用了max2020后,视口能稳定不低于20帧预览,不过反正最后都要拍屏检查自己作业的)

[演示IRig的汉化界面和创建绑定过程]

保险起见,预先整理了所有模型和贴图,确定渲染没问题后,才开始后续制作.

最后输出基本采用2D感的渲染,顺便也可以和我以前的作品风格融合,最重要的是,可以以极低的成本达到不错的最终效果.

一开始整体使用了Vray材质,后来发现其实标准材质就可以,并且实现和显示兼容性也更好,但是两个材质混合的这部分给我带来了困扰,Blender里有现成的多点腐蚀的效果教程,max实现这个效果的方法我找了很长时间才找到,最后利用Vray5学习版的即时渲染完成了材质调整和绑定.

[演示实时渲染结果和材质渐变效果]

剩下的绑定基本都需要手动来搞了,在IRig绑定的基础上,参考Blender的Rigfy系统对控制器做了一些美化.这期间,由于IRig的原因出了严重的问题,不得不修复了其代码,并重新绑定了一遍.

头发,披风和其他物体的绑定基本完全是手动完成,披风的权重借助了一下Blender的权重传递功能.

在整理,手动绑定和美化的过程中,我顺便优化和扩展了一下自己以前的工具.

[演示塌陷模型和拼图命名器和替换物体]

头发的权重直接套用了原绑定中从fbx传递过来的权重,披风和身体的权重是重新制作的.在制作披风和身体权重的时候,因为某些部分的骨骼比较复杂,而3dmax的skin缺少了一个很重要的权重锁定功能.为了效果能舒服一些,不得不把以前自己临时制作的,满是Bug的权重工具给重新制作了一遍.

令人欣慰的是,得到的回报是值得的.花了大量时间完成工具后,这次和以后都可以很快速的准确调整权重了.而且手感默认的权重工具基本一样,就像是一个"权重工具Plus".

后来添加眼睛的权重时,这个工具也起了很大作用,让我可以不用过多绑定,一根骨骼就控制眼皮.

[演示权重工具pro的锁定权重]

原版的眼睛都是用变形做的,为了让眼睛绑定转成兼容性更好的骨骼,还接近原绑定的效果花费了一些时间.

一开始打算将所有武器都做好绑定和切换,这样不论以后想拿哪个武器都可以拿来就用.但是这套的模型的道具真的很丰富,而我完成所有身体的绑定和权重时,已经过去一个月了.所以只好先绑定一根和我需求相符合的棍子武器.

[整体演示躯干,盆骨,手臂和腿的控制器,IKFK切换面板,眼部控制器,瞳孔控制器,道具的隐藏显示控制器,道具的子级控制器]

在这个绑定完成的时候,刚好看见了一个使用相同模型制作的小动画,很是精巧.正适合拿来做个临摹小练习,顺便测试一下现有绑定.

一番纠结之后,添加了剑和盾的绑定.然后一步一步的照着视频,按自己的理解复刻了一个临摹动画.

期间修复了不少蒙皮和绑定存在的问题,还用新的方案重新绑定了棍子.

虽然最后的动画结果还是差强人意,但我已经还算满意.

这次复刻实验中,其实学习到了不少东西,有些知识视频作者都没标注出来,缺蕴藏在制作过程分解之中的,临摹一次才能吸收一些.

[复刻过程]

这一阶段结束之后,终于重新回到主要目标了,马上开始着手制作原来的对打小作品.

毕竟是自己的东西,自己做主,打算按照`资料-设计-预览-制作-细化-渲染`来走流程,这样也能适当减少不可控的反馈成本.

动作设计是打算两个角色使用棍子对打,棍子是我最喜欢的武器之一,打斗的动作尽量互有进退,不分强弱,pose帅气夸张一些.想了想,做成循环的比较好.



