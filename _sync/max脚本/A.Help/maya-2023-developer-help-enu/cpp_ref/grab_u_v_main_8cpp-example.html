<!-- saved from url=(0024)http://docs.autodesk.com -->
<html>
   <head><script src="../scripts/yepnope.1.5.4-min.js" type="text/javascript"></script><script src="../scripts/lib/jquery-1.11.1.min.js" type="text/javascript"></script>
      <title>C++ API Reference: grabUVMain.cpp</title>
      
	  
      
      
      
      
      
      
      
    

</head>
   <body height="100%"><div class="body_content" id="body-content"><link rel="stylesheet" type="text/css" href="cpp_ref/navtree.css"><link rel="stylesheet" type="text/css" href="cpp_ref/doxygen.css"><link rel="stylesheet" type="text/css" href="cpp_ref/tabs.css"><link rel="stylesheet" type="text/css" href="style/adsk.cpm.css"><script type="text/javascript">
var tocSystemNeedsToBeLoaded = typeof(cpp_ref_adsk_ref_toc) == 'undefined';
var weAreIn21 = $('div#main.view-active').length;
var tocPrefix = '';
if (weAreIn21)
{ tocPrefix = 'cpp_ref/'; }
function cpp_ref_initializeToc(forceTrigger) {
    cpp_ref_adsk_ref_toc.initResizable();
    cpp_ref_adsk_ref_toc.initNavTree('grab_u_v_main_8cpp-example.html', tocPrefix);
    dQuery(document).trigger('toc_initialized');
}
if (tocSystemNeedsToBeLoaded)
{
	yepnope([{
	load:[tocPrefix + 'json3.min.js', tocPrefix + 'jquery.js', tocPrefix + 'ref-toc-controller.js', tocPrefix + 'dynsections.js'],
	complete: function() {
	  if (typeof(dQuery) == 'undefined')
	  {
	    dQuery = jQuery.noConflict(true);
	  }
	  else { jQuery.noConflict(true); }
	  $(document).ready(cpp_ref_initializeToc);
	}
 	}])
}
if (!weAreIn21) { // if in AKN...
$(window).load( function() {
    setTimeout( function() {
        var content = $('body > div').not('#body-content');     // take any divs under body that are not id=body-content
        content.each( function() { 
            $(this).css( { 'padding-left': $(this).css('margin-left') } );       // and if they have any padding-left already, move it to margin-left.
        } );
        var width = cpp_ref_adsk_ref_toc.readFromStorage('width');
        content.css({marginLeft:parseInt(width)+6+"px"});
    }, 100);
} ); 
}
</script><script>
 if (!tocSystemNeedsToBeLoaded) { cpp_ref_initializeToc(); }
 </script>
      <div>
         <div class="head">
            <h1>C++ API Reference: grabUVMain.cpp</h1>
         </div>

<div id="top"><!-- do not remove this div, it is closed by doxygen! -->

<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->

  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="#!/url=./cpp_ref/index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="#!/url=./cpp_ref/pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="#!/url=./cpp_ref/modules.html"><span>Modules</span></a></li>
      <li><a href="#!/url=./cpp_ref/namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="#!/url=./cpp_ref/annotated.html"><span>Classes</span></a></li>
      <li><a href="#!/url=./cpp_ref/examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="cpp_ref/search/mag_sel.png" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" alt="">
          <input type="text" id="MSearchField" value="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)">
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="cpp_ref/search/close.png" alt=""></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" class="ui-resizable-handle">
  </div>
</div>

<div id="doc-content">
<!-- window showing the filter options -->


<!-- iframe showing the search results (closed by default) -->


<div class="header">
  <div class="headertitle">
<div class="title">grabUVMain.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">// Copyright 2015 Autodesk, Inc. All rights reserved.</span></div>
<div class="line"><span class="comment">// </span></div>
<div class="line"><span class="comment">// Use of this software is subject to the terms of the Autodesk</span></div>
<div class="line"><span class="comment">// license agreement provided at the time of installation or download,</span></div>
<div class="line"><span class="comment">// or which otherwise accompanies this software in either electronic</span></div>
<div class="line"><span class="comment">// or hard copy form.</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// File: pluginMain.cpp</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Author: Maya Plug-in Wizard 2.0</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="preprocessor">#include &lt;QtCore/QObject&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;QtWidgets/QApplication&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;QtCore/QEvent&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;QtGui/QKeyEvent&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MFnPlugin.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MIOStream.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MStatus.h&gt;</span>     </div>
<div class="line"><span class="preprocessor">#include &lt;maya/MEvent.h&gt;</span> </div>
<div class="line"><span class="preprocessor">#include &lt;maya/MGlobal.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MItSelectionList.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MFnSingleIndexedComponent.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MDagPath.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MFn.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MFnMesh.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MPoint.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MVector.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MMatrix.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MIntArray.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MFloatArray.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MUintArray.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MToolsInfo.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MUIDrawManager.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MFrameContext.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MColor.h&gt;</span> </div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MPxTexContext.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MPxContextCommand.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MPxPolyTweakUVInteractiveCommand.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span>UVUpdateCommand : <span class="keyword">public</span> <a name="_a0"></a><a class="code" href="#!/url=./cpp_ref/class_m_px_poly_tweak_u_v_interactive_command.html">MPxPolyTweakUVInteractiveCommand</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">void</span> *creator() { <span class="keywordflow">return</span> <span class="keyword">new</span> UVUpdateCommand; };</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>BrushConfig</div>
<div class="line">{</div>
<div class="line">    BrushConfig() : fSize(50.0f) {};</div>
<div class="line">    <span class="keywordtype">float</span> size()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> fSize; }</div>
<div class="line">    <span class="keywordtype">void</span> setSize( <span class="keywordtype">float</span> size ) { fSize = size; }</div>
<div class="line"></div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">float</span> fSize;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span>grabUVContext : <span class="keyword">public</span> QObject, <span class="keyword">public</span> <a name="_a1"></a><a class="code" href="#!/url=./cpp_ref/class_m_px_tex_context.html">MPxTexContext</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"></div>
<div class="line">    <span class="comment">// constructor</span></div>
<div class="line">    grabUVContext();</div>
<div class="line"></div>
<div class="line">    <span class="comment">// destructor</span></div>
<div class="line">    <span class="keyword">virtual</span> ~grabUVContext() {} ;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a name="a2"></a><a class="code" href="#!/url=./cpp_ref/class_m_px_context.html#a658f83d3a196c6c8e77e7ed2655eb6d7">toolOnSetup</a>( <a name="_a3"></a><a class="code" href="#!/url=./cpp_ref/class_m_event.html">MEvent</a> &amp; event );</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a name="a4"></a><a class="code" href="#!/url=./cpp_ref/class_m_px_context.html#a1a7ea794ab903ce98dfe7498619a2518">toolOffCleanup</a>();</div>
<div class="line"></div>
<div class="line">    <span class="keyword">virtual</span> <a name="_a5"></a><a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a> <a name="a6"></a><a class="code" href="#!/url=./cpp_ref/class_m_px_tex_context.html#a7621af00b7ec3c83d9f417c1e18a0686">doPress</a> ( <a class="code" href="#!/url=./cpp_ref/class_m_event.html">MEvent</a> &amp; event, <a name="_a7"></a><a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_u_i_draw_manager.html">MHWRender::MUIDrawManager</a>&amp; drawMgr, <span class="keyword">const</span> <a name="_a8"></a><a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_frame_context.html">MHWRender::MFrameContext</a>&amp; context);</div>
<div class="line">    <span class="keyword">virtual</span> <a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a> <a name="a9"></a><a class="code" href="#!/url=./cpp_ref/class_m_px_tex_context.html#a9ec58a753aa3c435d139e3aab719c057">doRelease</a>( <a class="code" href="#!/url=./cpp_ref/class_m_event.html">MEvent</a> &amp; event, <a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_u_i_draw_manager.html">MHWRender::MUIDrawManager</a>&amp; drawMgr, <span class="keyword">const</span> <a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_frame_context.html">MHWRender::MFrameContext</a>&amp; context);</div>
<div class="line">    <span class="keyword">virtual</span> <a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a> <a name="a10"></a><a class="code" href="#!/url=./cpp_ref/class_m_px_tex_context.html#a4cbd5f86ed5a4ab444451bfeae40e45a">doDrag</a> ( <a class="code" href="#!/url=./cpp_ref/class_m_event.html">MEvent</a> &amp; event, <a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_u_i_draw_manager.html">MHWRender::MUIDrawManager</a>&amp; drawMgr, <span class="keyword">const</span> <a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_frame_context.html">MHWRender::MFrameContext</a>&amp; context); </div>
<div class="line">    <span class="keyword">virtual</span> <a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a> <a name="a11"></a><a class="code" href="#!/url=./cpp_ref/class_m_px_tex_context.html#aa3f8f328b88ed162b1398227f3cea83e">doPtrMoved</a> ( <a class="code" href="#!/url=./cpp_ref/class_m_event.html">MEvent</a> &amp; event, <a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_u_i_draw_manager.html">MHWRender::MUIDrawManager</a>&amp; drawMgr, <span class="keyword">const</span> <a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_frame_context.html">MHWRender::MFrameContext</a>&amp; context);</div>
<div class="line">    <span class="keyword">virtual</span> <a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a> <a name="a12"></a><a class="code" href="#!/url=./cpp_ref/class_m_px_context.html#ad86a55c92f170b1578fb3fe6fa88cbb7">drawFeedback</a> ( <a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_u_i_draw_manager.html">MHWRender::MUIDrawManager</a>&amp; drawMgr, <span class="keyword">const</span> <a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_frame_context.html">MHWRender::MFrameContext</a>&amp; context);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">bool</span>            doKeyPress( QKeyEvent* event );</div>
<div class="line">    <span class="keywordtype">bool</span>            doKeyRelease( QKeyEvent* event );</div>
<div class="line"></div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a name="a13"></a><a class="code" href="#!/url=./cpp_ref/class_m_px_context.html#a79eb9c170168f8755d68c3147d6c1676">getClassName</a>(<a name="_a14"></a><a class="code" href="#!/url=./cpp_ref/class_m_string.html">MString</a> &amp; name) <span class="keyword">const</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span>    eventFilter(QObject *<span class="keywordtype">object</span>, QEvent *event);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">float</span>   size() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">void</span>    setSize( <span class="keywordtype">float</span> size );</div>
<div class="line"></div>
<div class="line"><span class="keyword">private</span>:             </div>
<div class="line"></div>
<div class="line">    <span class="keyword">enum</span> DragMode</div>
<div class="line">    {</div>
<div class="line">        kNormal,</div>
<div class="line">        kBrushSize</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    BrushConfig     fBrushConfig;</div>
<div class="line">    DragMode        fDragMode;</div>
<div class="line">    <span class="keywordtype">bool</span>            fInStroke;</div>
<div class="line"></div>
<div class="line">    <a name="_a15"></a><a class="code" href="#!/url=./cpp_ref/class_m_point.html">MPoint</a>          fCurrentPoint;</div>
<div class="line">    <a class="code" href="#!/url=./cpp_ref/class_m_point.html">MPoint</a>          fLastPoint;</div>
<div class="line">    <a class="code" href="#!/url=./cpp_ref/class_m_point.html">MPoint</a>          fBrushCenterScreenPoint;</div>
<div class="line">    <a class="code" href="#!/url=./cpp_ref/class_m_point.html">MPoint</a>          fCurrentScreenPoint;</div>
<div class="line">    <a class="code" href="#!/url=./cpp_ref/class_m_point.html">MPoint</a>          fLastScreenPoint;</div>
<div class="line">    UVUpdateCommand *fCommand;</div>
<div class="line">    <a name="_a16"></a><a class="code" href="#!/url=./cpp_ref/class_m_dag_path.html">MDagPath</a>        fDagPath;</div>
<div class="line">    <a name="_a17"></a><a class="code" href="#!/url=./cpp_ref/class_m_int_array.html">MIntArray</a>       fCollectedUVs;</div>
<div class="line">    <a class="code" href="#!/url=./cpp_ref/class_m_global.html#a5b78971d76a21fe10e157bbb39983cfc">MGlobal::MSelectionMode</a> fPreviousSelectionMode;</div>
<div class="line">    <a name="_a18"></a><a class="code" href="#!/url=./cpp_ref/class_m_selection_mask.html">MSelectionMask</a>  fPreviousSelectionMask;</div>
<div class="line">}; </div>
<div class="line"></div>
<div class="line">grabUVContext::grabUVContext() :</div>
<div class="line">    fCommand(NULL),</div>
<div class="line">    fInStroke(false),</div>
<div class="line">    fDragMode(kNormal)</div>
<div class="line">{</div>
<div class="line"></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">float</span> grabUVContext::size()<span class="keyword"> const </span></div>
<div class="line"><span class="keyword"></span>{ </div>
<div class="line">    <span class="keywordflow">return</span> fBrushConfig.size();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> grabUVContext::setSize( <span class="keywordtype">float</span> size )</div>
<div class="line">{ </div>
<div class="line">    fBrushConfig.setSize( size ); </div>
<div class="line">    <a name="a19"></a><a class="code" href="#!/url=./cpp_ref/class_m_tools_info.html#a5f1bc27778c881159a7e486934261015">MToolsInfo::setDirtyFlag</a>(*<span class="keyword">this</span>); </div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> grabUVContext::toolOnSetup( <a class="code" href="#!/url=./cpp_ref/class_m_event.html">MEvent</a> &amp;event )</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="#!/url=./cpp_ref/class_m_px_context.html#a658f83d3a196c6c8e77e7ed2655eb6d7">MPxTexContext::toolOnSetup</a>( event );</div>
<div class="line"></div>
<div class="line">    QCoreApplication *app = qApp;</div>
<div class="line">    app-&gt;installEventFilter(<span class="keyword">this</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> grabUVContext::toolOffCleanup()</div>
<div class="line">{</div>
<div class="line">    QCoreApplication *app = qApp;</div>
<div class="line">    app-&gt;removeEventFilter(<span class="keyword">this</span>);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="#!/url=./cpp_ref/class_m_px_context.html#a1a7ea794ab903ce98dfe7498619a2518">MPxTexContext::toolOffCleanup</a>();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> grabUVContext::eventFilter( QObject * <span class="keywordtype">object</span>, QEvent *event )</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( QKeyEvent* e = dynamic_cast&lt;QKeyEvent*&gt;(event) )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span>( e-&gt;type() == QEvent::KeyPress )</div>
<div class="line">            doKeyPress( e );</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( e-&gt;type() == QEvent::KeyRelease )</div>
<div class="line">            doKeyRelease( e );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// if we return true, the event won&#39;t get propagated</span></div>
<div class="line">    <span class="comment">// to the rest of the widgets.</span></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> grabUVContext::doKeyPress( QKeyEvent* event )</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( fInStroke )</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( event-&gt;key() == Qt::Key_B ) </div>
<div class="line">    {</div>
<div class="line">        fDragMode = kBrushSize;</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> grabUVContext::doKeyRelease( QKeyEvent* event )</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( fInStroke )</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( fDragMode != kNormal )</div>
<div class="line">    {</div>
<div class="line">        fDragMode = kNormal;</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"><a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a> grabUVContext::doPress ( <a class="code" href="#!/url=./cpp_ref/class_m_event.html">MEvent</a> &amp; event, <a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_u_i_draw_manager.html">MHWRender::MUIDrawManager</a>&amp; drawMgr, <span class="keyword">const</span> <a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_frame_context.html">MHWRender::MFrameContext</a>&amp; context)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> ( event.<a name="a20"></a><a class="code" href="#!/url=./cpp_ref/class_m_event.html#a80d4daf707c95e6f64086aab4af1ea89">mouseButton</a>() != <a name="a21"></a><a class="code" href="#!/url=./cpp_ref/class_m_event.html#a74edaa52c666cd1eca8562a6a7b7e629a472f470ec1325bba29564ad3c8716cb3">MEvent::kLeftMouse</a> || </div>
<div class="line">        !<span class="keyword">event</span>.isModifierNone() )</div>
<div class="line">        <span class="keywordflow">return</span> MS::kFailure;</div>
<div class="line"></div>
<div class="line">    fInStroke = <span class="keyword">true</span>;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="#!/url=./cpp_ref/class_m_px_tex_context.html#a7621af00b7ec3c83d9f417c1e18a0686">MPxTexContext::doPress</a>(event, drawMgr, context);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">short</span> x, y;</div>
<div class="line">    <span class="keyword">event</span>.getPosition( x, y );</div>
<div class="line">    fCurrentScreenPoint = <a class="code" href="#!/url=./cpp_ref/class_m_point.html">MPoint</a>( x, y );</div>
<div class="line">    fLastScreenPoint = <a class="code" href="#!/url=./cpp_ref/class_m_point.html">MPoint</a>( x, y );</div>
<div class="line">    fBrushCenterScreenPoint = <a class="code" href="#!/url=./cpp_ref/class_m_point.html">MPoint</a>( x, y );</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> xView, yView;</div>
<div class="line">    portToView(x, y, xView, yView); <span class="comment">// pos at viewrect coordinate  </span></div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> portW, portH;</div>
<div class="line">    portSize(portW, portH);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> left, right, bottom, top;</div>
<div class="line">    viewRect(left, right, bottom, top);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> sizeInView = portW &lt; 1e-5 ? 0.0 : ( fBrushConfig.size() * (right - left) / portW );</div>
<div class="line">    <span class="keywordtype">double</span> sizeInViewSquare = sizeInView * sizeInView;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( fDragMode == kNormal )</div>
<div class="line">    {</div>
<div class="line">        fCollectedUVs.clear();</div>
<div class="line"></div>
<div class="line">        <a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a> *returnStatus = NULL;</div>
<div class="line">        <a class="code" href="#!/url=./cpp_ref/class_m_selection_mask.html">MSelectionMask</a> mask = <a name="a22"></a><a class="code" href="#!/url=./cpp_ref/class_m_selection_mask.html#acffca3b33fddce63d3220bc7487e879da78abdaf084192b4bb84265bd1094d03a">MSelectionMask::kSelectMeshUVs</a>;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">bool</span> bPickSingle = <span class="keyword">false</span>;</div>
<div class="line">        <a name="_a23"></a><a class="code" href="#!/url=./cpp_ref/class_m_selection_list.html">MSelectionList</a>  selectionList;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">bool</span> bSelect = <a name="a24"></a><a class="code" href="#!/url=./cpp_ref/class_m_px_tex_context.html#a2393d05257129bd75cbce23928978515">MPxTexContext::getMarqueeSelection</a>( x - fBrushConfig.size(), y - fBrushConfig.size(), </div>
<div class="line">                                                           x + fBrushConfig.size(), y + fBrushConfig.size(), </div>
<div class="line">                                                           mask, bPickSingle, <span class="keyword">true</span>, selectionList );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (bSelect)</div>
<div class="line">        {</div>
<div class="line">            <a name="_a25"></a><a class="code" href="#!/url=./cpp_ref/class_m_object.html">MObject</a> component;</div>
<div class="line">            selectionList.<a name="a26"></a><a class="code" href="#!/url=./cpp_ref/class_m_selection_list.html#a16dda1a34d5f10be257d8421ac6deabd">getDagPath</a>( 0, fDagPath, component );</div>
<div class="line">            fDagPath.extendToShape();</div>
<div class="line"></div>
<div class="line">            <a name="_a27"></a><a class="code" href="#!/url=./cpp_ref/class_m_fn_mesh.html">MFnMesh</a> mesh(fDagPath);</div>
<div class="line"></div>
<div class="line">            <a class="code" href="#!/url=./cpp_ref/class_m_string.html">MString</a> currentUVSetName;</div>
<div class="line">            mesh.getCurrentUVSetName(currentUVSetName);</div>
<div class="line"></div>
<div class="line">            <a class="code" href="#!/url=./cpp_ref/class_m_int_array.html">MIntArray</a> UVsToTest;</div>
<div class="line">            <span class="keywordflow">if</span>( component.<a name="a28"></a><a class="code" href="#!/url=./cpp_ref/class_m_object.html#a7e5fd5d37dde6df8c0cf350e00ca0a75">apiType</a>() == <a name="a29"></a><a class="code" href="#!/url=./cpp_ref/class_m_fn.html#a1d1cfd8ffb84e947f82999c682b666a7a0b774c2a128a8b2365fff164212f2e43">MFn::kMeshMapComponent</a> )</div>
<div class="line">            {</div>
<div class="line">                <a name="_a30"></a><a class="code" href="#!/url=./cpp_ref/class_m_fn_single_indexed_component.html">MFnSingleIndexedComponent</a> compFn( component );</div>
<div class="line">                compFn.getElements( UVsToTest );</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; UVsToTest.<a name="a31"></a><a class="code" href="#!/url=./cpp_ref/class_m_int_array.html#a580388f31f60c46fac867ca48a48da1e">length</a>(); ++i)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordtype">float</span> u, v;</div>
<div class="line">                    <a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a> bGetUV = mesh.getUV(UVsToTest[i], u, v, &amp;currentUVSetName);</div>
<div class="line">                    <span class="keywordflow">if</span> (bGetUV == MS::kSuccess)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordtype">float</span> distSquare = ( u - xView ) * ( u - xView ) + ( v - yView ) * ( v - yView );</div>
<div class="line">                        <span class="keywordflow">if</span> ( distSquare &lt; sizeInViewSquare )</div>
<div class="line">                            fCollectedUVs.append(UVsToTest[i]);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// position in view(world) space. </span></div>
<div class="line">            fLastPoint = <a class="code" href="#!/url=./cpp_ref/class_m_point.html">MPoint</a>( xView, yView, 0.0 );</div>
<div class="line">            fCurrentPoint = <a class="code" href="#!/url=./cpp_ref/class_m_point.html">MPoint</a>( xView, yView, 0.0 );</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> MS::kSuccess;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a> grabUVContext::doRelease( <a class="code" href="#!/url=./cpp_ref/class_m_event.html">MEvent</a> &amp; event, <a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_u_i_draw_manager.html">MHWRender::MUIDrawManager</a>&amp; drawMgr, <span class="keyword">const</span> <a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_frame_context.html">MHWRender::MFrameContext</a>&amp; context)</div>
<div class="line">{</div>
<div class="line">    fInStroke = <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (fCommand)</div>
<div class="line">        fCommand-&gt;finalize();</div>
<div class="line">    fCommand = NULL;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="#!/url=./cpp_ref/class_m_px_tex_context.html#a9ec58a753aa3c435d139e3aab719c057">MPxTexContext::doRelease</a>(event, drawMgr, context);</div>
<div class="line">    <span class="keywordflow">return</span> MS::kSuccess;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a> grabUVContext::doDrag ( <a class="code" href="#!/url=./cpp_ref/class_m_event.html">MEvent</a> &amp; event, <a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_u_i_draw_manager.html">MHWRender::MUIDrawManager</a>&amp; drawMgr, <span class="keyword">const</span> <a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_frame_context.html">MHWRender::MFrameContext</a>&amp; context)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (event.<a class="code" href="#!/url=./cpp_ref/class_m_event.html#a80d4daf707c95e6f64086aab4af1ea89">mouseButton</a>() != <a class="code" href="#!/url=./cpp_ref/class_m_event.html#a74edaa52c666cd1eca8562a6a7b7e629a472f470ec1325bba29564ad3c8716cb3">MEvent::kLeftMouse</a> || </div>
<div class="line">        !<span class="keyword">event</span>.isModifierNone() )</div>
<div class="line">        <span class="keywordflow">return</span> MS::kFailure;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="#!/url=./cpp_ref/class_m_px_tex_context.html#a4cbd5f86ed5a4ab444451bfeae40e45a">MPxTexContext::doDrag</a>(event, drawMgr, context);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">short</span> x, y;</div>
<div class="line">    <span class="keyword">event</span>.getPosition( x, y );</div>
<div class="line">    fLastScreenPoint = fCurrentScreenPoint;</div>
<div class="line">    fCurrentScreenPoint = <a class="code" href="#!/url=./cpp_ref/class_m_point.html">MPoint</a>( x, y );</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> xView, yView;</div>
<div class="line">    portToView(x, y, xView, yView); <span class="comment">// pos at viewrect coordinate</span></div>
<div class="line"></div>
<div class="line">    fLastPoint = fCurrentPoint;</div>
<div class="line">    fCurrentPoint = <a class="code" href="#!/url=./cpp_ref/class_m_point.html">MPoint</a>( xView, yView, 0.0 );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( fDragMode == kBrushSize )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">double</span> dis = fCurrentScreenPoint.distanceTo( fLastScreenPoint );</div>
<div class="line">        <span class="keywordflow">if</span> ( fCurrentScreenPoint[0] &gt; fLastScreenPoint[0] )</div>
<div class="line">            setSize( size() + <span class="keywordtype">float</span>(dis) );</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            setSize( std::max( size() - <span class="keywordtype">float</span>(dis), 0.01f ) );</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        fBrushCenterScreenPoint = <a class="code" href="#!/url=./cpp_ref/class_m_point.html">MPoint</a>( x, y );</div>
<div class="line"></div>
<div class="line">        <a name="_a32"></a><a class="code" href="#!/url=./cpp_ref/class_m_float_array.html">MFloatArray</a> uUVsExported;</div>
<div class="line">        <a class="code" href="#!/url=./cpp_ref/class_m_float_array.html">MFloatArray</a> vUVsExported;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">const</span> <a name="_a33"></a><a class="code" href="#!/url=./cpp_ref/class_m_vector.html">MVector</a> vec = fCurrentPoint - fLastPoint;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (!fCommand)</div>
<div class="line">        {</div>
<div class="line">            fCommand = (UVUpdateCommand *)(newToolCommand());</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (fCommand)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="#!/url=./cpp_ref/class_m_fn_mesh.html">MFnMesh</a> mesh(fDagPath);</div>
<div class="line">            <a class="code" href="#!/url=./cpp_ref/class_m_string.html">MString</a> currentUVSetName;</div>
<div class="line">            mesh.getCurrentUVSetName(currentUVSetName);</div>
<div class="line"></div>
<div class="line">            <span class="keywordtype">int</span> nbUVs = mesh.numUVs(currentUVSetName);</div>
<div class="line">            <a name="_a34"></a><a class="code" href="#!/url=./cpp_ref/class_m_double_array.html">MDoubleArray</a> pinData;</div>
<div class="line">            <a name="_a35"></a><a class="code" href="#!/url=./cpp_ref/class_m_uint_array.html">MUintArray</a> uvPinIds;</div>
<div class="line">            <a class="code" href="#!/url=./cpp_ref/class_m_double_array.html">MDoubleArray</a> fullPinData;</div>
<div class="line">            mesh.getPinUVs(uvPinIds, pinData, &amp;currentUVSetName);</div>
<div class="line">            <span class="keywordtype">int</span> len = pinData.<a name="a36"></a><a class="code" href="#!/url=./cpp_ref/class_m_double_array.html#a580388f31f60c46fac867ca48a48da1e">length</a>();</div>
<div class="line"></div>
<div class="line">            fullPinData.<a name="a37"></a><a class="code" href="#!/url=./cpp_ref/class_m_double_array.html#a8c66dfa06f3736b2a214c5aed58bd216">setLength</a>(nbUVs);</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nbUVs; i++) {</div>
<div class="line">                fullPinData[i] = 0.0;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">while</span>( len-- &gt; 0 ) {</div>
<div class="line">                fullPinData[uvPinIds[len]] = pinData[len];</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <a class="code" href="#!/url=./cpp_ref/class_m_float_array.html">MFloatArray</a> uValues;</div>
<div class="line">            <a class="code" href="#!/url=./cpp_ref/class_m_float_array.html">MFloatArray</a> vValues;</div>
<div class="line">            <span class="keywordtype">float</span> pinWeight = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; fCollectedUVs.length(); ++i)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordtype">float</span> u, v;</div>
<div class="line">                <a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a> bGetUV = mesh.getUV(fCollectedUVs[i], u, v, &amp;currentUVSetName);</div>
<div class="line">                <span class="keywordflow">if</span> (bGetUV == MS::kSuccess)</div>
<div class="line">                {</div>
<div class="line">                    pinWeight = fullPinData[fCollectedUVs[i]];</div>
<div class="line">                    u += (float)vec[0]*(1-pinWeight);</div>
<div class="line">                    v += (float)vec[1]*(1-pinWeight);</div>
<div class="line">                    uValues.<a name="a38"></a><a class="code" href="#!/url=./cpp_ref/class_m_float_array.html#a6d61a0ea5cd7a087db5ee81a990d4307">append</a>( u );</div>
<div class="line">                    vValues.<a class="code" href="#!/url=./cpp_ref/class_m_float_array.html#a6d61a0ea5cd7a087db5ee81a990d4307">append</a>( v ); </div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            fCommand-&gt;setUVs( mesh.object(), fCollectedUVs, uValues, vValues, &amp;currentUVSetName );</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> MS::kSuccess;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a> grabUVContext::doPtrMoved( <a class="code" href="#!/url=./cpp_ref/class_m_event.html">MEvent</a> &amp; event, <a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_u_i_draw_manager.html">MHWRender::MUIDrawManager</a>&amp; drawMgr, <span class="keyword">const</span> <a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_frame_context.html">MHWRender::MFrameContext</a>&amp; context)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="#!/url=./cpp_ref/class_m_px_tex_context.html#aa3f8f328b88ed162b1398227f3cea83e">MPxTexContext::doPtrMoved</a>(event, drawMgr, context);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> portW, portH;</div>
<div class="line">    portSize(portW, portH);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">short</span> x, y;</div>
<div class="line">    <span class="keyword">event</span>.getPosition( x, y );</div>
<div class="line"></div>
<div class="line">    y = short(portH) - y;</div>
<div class="line"></div>
<div class="line">    fCurrentScreenPoint = <a class="code" href="#!/url=./cpp_ref/class_m_point.html">MPoint</a>( x, y );</div>
<div class="line">    fLastScreenPoint = <a class="code" href="#!/url=./cpp_ref/class_m_point.html">MPoint</a>( x, y );</div>
<div class="line">    fBrushCenterScreenPoint = <a class="code" href="#!/url=./cpp_ref/class_m_point.html">MPoint</a>( x, y );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> MS::kSuccess;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a> grabUVContext::drawFeedback(<a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_u_i_draw_manager.html">MHWRender::MUIDrawManager</a>&amp; drawMgr, <span class="keyword">const</span> <a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_frame_context.html">MHWRender::MFrameContext</a>&amp; context)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// to draw the brush ring.</span></div>
<div class="line">    drawMgr.<a name="a39"></a><a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_u_i_draw_manager.html#a9008ebfa63c02670625076230d77c3f9">beginDrawable</a>();</div>
<div class="line">    {</div>
<div class="line">        drawMgr.<a name="a40"></a><a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_u_i_draw_manager.html#a9baede3e37abe9551e50a8c6be65ec4d">setColor</a>( <a name="_a41"></a><a class="code" href="#!/url=./cpp_ref/class_m_color.html">MColor</a>(1.f, 1.f, 1.f) ); </div>
<div class="line">        drawMgr.<a name="a42"></a><a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_u_i_draw_manager.html#a00a63eea91630b196deea094e30c0f42">setLineWidth</a>( 2.0f );</div>
<div class="line">        drawMgr.<a name="a43"></a><a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_u_i_draw_manager.html#ab7d5ddc19d298f47247624c95647e7d1">circle2d</a>(<a class="code" href="#!/url=./cpp_ref/class_m_point.html">MPoint</a>(fBrushCenterScreenPoint.x, fBrushCenterScreenPoint.y), fBrushConfig.size());</div>
<div class="line">    }               </div>
<div class="line">    drawMgr.<a name="a44"></a><a class="code" href="#!/url=./cpp_ref/class_m_h_w_render_1_1_m_u_i_draw_manager.html#a78c343c25a05be7e46dd4b7ebab82ff6">endDrawable</a>();</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> MS::kSuccess;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> grabUVContext::getClassName( <a class="code" href="#!/url=./cpp_ref/class_m_string.html">MString</a> &amp; name )<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">    name.<a name="a45"></a><a class="code" href="#!/url=./cpp_ref/class_m_string.html#acee761fe098fc30a5ac1437e3aca5bc0">set</a>(<span class="stringliteral">&quot;grabUV&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define kSizeFlag           &quot;-sz&quot;</span></div>
<div class="line"><span class="preprocessor">#define kSizeFlagLong       &quot;-size&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">//---------------------------------------------</span></div>
<div class="line"><span class="keyword">class </span>grabUVContextCommand : <span class="keyword">public</span> <a name="_a46"></a><a class="code" href="#!/url=./cpp_ref/class_m_px_context_command.html">MPxContextCommand</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:  </div>
<div class="line">                        grabUVContextCommand();</div>
<div class="line">    <span class="keyword">virtual</span> <a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a>     <a name="a47"></a><a class="code" href="#!/url=./cpp_ref/class_m_px_context_command.html#a8398b14f3ec13c9f7b12ff06b7b5bc60">doEditFlags</a>();</div>
<div class="line">    <span class="keyword">virtual</span> <a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a>     <a name="a48"></a><a class="code" href="#!/url=./cpp_ref/class_m_px_context_command.html#aac27812cb6ea1797b391dde62d2a6359">doQueryFlags</a>();</div>
<div class="line">    <span class="keyword">virtual</span> <a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a>     <a name="a49"></a><a class="code" href="#!/url=./cpp_ref/class_m_px_context_command.html#aebce411ed7652b491d2b7c1938b8042c">appendSyntax</a>();</div>
<div class="line">    <span class="keyword">virtual</span> <a name="_a50"></a><a class="code" href="#!/url=./cpp_ref/class_m_px_context.html">MPxContext</a>* <a name="a51"></a><a class="code" href="#!/url=./cpp_ref/class_m_px_context_command.html#a69d6fc56205518e4be6c0ced911e6523">makeObj</a>();</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">void</span>*        creator();</div>
<div class="line"></div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">    grabUVContext*      fGrabUVContext;</div>
<div class="line">};          </div>
<div class="line"></div>
<div class="line">grabUVContextCommand::grabUVContextCommand() {}</div>
<div class="line"></div>
<div class="line"><a class="code" href="#!/url=./cpp_ref/class_m_px_context.html">MPxContext</a>* grabUVContextCommand::makeObj()</div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Description</span></div>
<div class="line"><span class="comment">//    When the context command is executed in maya, this method</span></div>
<div class="line"><span class="comment">//    be used to create a context.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line">{</div>
<div class="line">    fGrabUVContext = <span class="keyword">new</span> grabUVContext();</div>
<div class="line">    <span class="keywordflow">return</span> fGrabUVContext;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span>* grabUVContextCommand::creator()</div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Description</span></div>
<div class="line"><span class="comment">//    This method creates the context command.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">new</span> grabUVContextCommand;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a> grabUVContextCommand::doEditFlags()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a> status = MS::kSuccess;</div>
<div class="line"></div>
<div class="line">    <a name="_a52"></a><a class="code" href="#!/url=./cpp_ref/class_m_arg_parser.html">MArgParser</a> argData = parser();</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (argData.<a name="a53"></a><a class="code" href="#!/url=./cpp_ref/class_m_arg_parser.html#aa38abc6623182dacee0fcb4136e403b8">isFlagSet</a>(kSizeFlag)) {</div>
<div class="line">        <span class="keywordtype">double</span> size;</div>
<div class="line">        status = argData.<a name="a54"></a><a class="code" href="#!/url=./cpp_ref/class_m_arg_parser.html#a74bdc5edb84381a46ce3a0de74230938">getFlagArgument</a>(kSizeFlag, 0, size);</div>
<div class="line">        <span class="keywordflow">if</span> (!status) {</div>
<div class="line">            status.<a name="a55"></a><a class="code" href="#!/url=./cpp_ref/class_m_status.html#a1f01a4748fea4d8bcced082df83f804d">perror</a>(<span class="stringliteral">&quot;size flag parsing failed.&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> status;</div>
<div class="line">        }</div>
<div class="line">        fGrabUVContext-&gt;setSize( <span class="keywordtype">float</span>(size) );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> MS::kSuccess;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a> grabUVContextCommand::doQueryFlags()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="#!/url=./cpp_ref/class_m_arg_parser.html">MArgParser</a> argData = parser();</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (argData.<a class="code" href="#!/url=./cpp_ref/class_m_arg_parser.html#aa38abc6623182dacee0fcb4136e403b8">isFlagSet</a>(kSizeFlag)) {</div>
<div class="line">        setResult(fGrabUVContext-&gt;size());</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> MS::kSuccess;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a> grabUVContextCommand::appendSyntax()</div>
<div class="line">{</div>
<div class="line">    <a name="_a56"></a><a class="code" href="#!/url=./cpp_ref/class_m_syntax.html">MSyntax</a> mySyntax = syntax();</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (MS::kSuccess != mySyntax.<a name="a57"></a><a class="code" href="#!/url=./cpp_ref/class_m_syntax.html#aeaeaac3794bb4de8004afb1ac1829488">addFlag</a>(kSizeFlag, kSizeFlagLong,</div>
<div class="line">        <a name="a58"></a><a class="code" href="#!/url=./cpp_ref/class_m_syntax.html#ae6f2057f0d0419845a48c1eb6813f2adacd70f5d2b5e8c1bb8e83b0482a33e518">MSyntax::kDouble</a>)) {</div>
<div class="line">            <span class="keywordflow">return</span> MS::kFailure;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> MS::kSuccess;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// ------------------------------------------------------------------</span></div>
<div class="line"><span class="preprocessor">#define CTX_CREATOR_NAME &quot;grabUVContext&quot;</span></div>
<div class="line"><span class="preprocessor">#define TEX_COMMAND_NAME &quot;uvUpdateCommand&quot; </span></div>
<div class="line"></div>
<div class="line"><a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a> initializePlugin( <a class="code" href="#!/url=./cpp_ref/class_m_object.html">MObject</a> obj )</div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">//  Description:</span></div>
<div class="line">    <span class="comment">//      this method is called when the plug-in is loaded into Maya.  It </span></div>
<div class="line">    <span class="comment">//      registers all of the services that this plug-in provides with </span></div>
<div class="line">    <span class="comment">//      Maya.</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">//  Arguments:</span></div>
<div class="line">    <span class="comment">//      obj - a handle to the plug-in object (use MFnPlugin to access it)</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">{ </div>
<div class="line">    <a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a>   status;</div>
<div class="line">    <a name="_a59"></a><a class="code" href="#!/url=./cpp_ref/class_m_fn_plugin.html">MFnPlugin</a> plugin( obj, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;2015&quot;</span>, <span class="stringliteral">&quot;Any&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Add plug-in feature registration here</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    status = plugin.registerContextCommand(CTX_CREATOR_NAME, grabUVContextCommand::creator,</div>
<div class="line">        TEX_COMMAND_NAME, UVUpdateCommand::creator);</div>
<div class="line"></div>
<div class="line">    <a name="a60"></a><a class="code" href="#!/url=./cpp_ref/group___macros.html#ga2f3f1ac62ed663f5efd20ff99991335b">CHECK_MSTATUS_AND_RETURN_IT</a>(status);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a> uninitializePlugin( <a class="code" href="#!/url=./cpp_ref/class_m_object.html">MObject</a> obj )</div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">//  Description:</span></div>
<div class="line">    <span class="comment">//      this method is called when the plug-in is unloaded from Maya. It </span></div>
<div class="line">    <span class="comment">//      deregisters all of the services that it was providing.</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">//  Arguments:</span></div>
<div class="line">    <span class="comment">//      obj - a handle to the plug-in object (use MFnPlugin to access it)</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">{</div>
<div class="line">    <a class="code" href="#!/url=./cpp_ref/class_m_status.html">MStatus</a>   status;</div>
<div class="line">    <a class="code" href="#!/url=./cpp_ref/class_m_fn_plugin.html">MFnPlugin</a> plugin( obj );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Add plug-in feature deregistration here</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    status = plugin.deregisterContextCommand(CTX_CREATOR_NAME, TEX_COMMAND_NAME);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="#!/url=./cpp_ref/group___macros.html#ga2f3f1ac62ed663f5efd20ff99991335b">CHECK_MSTATUS_AND_RETURN_IT</a>(status);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->

      <div class="footer-block"><a href="../html/ac.cmtdialog.htm" class="comments-anchor" target="_blank"><span class="comments-link">Please send us your comment about this page</span></a></div></div>
   </div></body>
</html>
